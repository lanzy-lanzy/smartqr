{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Equipment Detail Modal Content -->
<div class="p-0 max-w-2xl bg-slate-900/95 backdrop-blur-xl border border-white/10 rounded-2xl overflow-hidden shadow-2xl animate-fadeIn lg:mx-auto">
    <!-- Header -->
    <div class="relative p-6 pb-4 bg-gradient-to-br from-green-500/5 via-transparent to-transparent flex items-start gap-5">
        <div class="w-20 h-20 rounded-xl bg-slate-800 border border-white/10 flex items-center justify-center flex-shrink-0">
            <i data-lucide="monitor" class="w-10 h-10 text-slate-400"></i>
        </div>
        
        <div class="flex-1 pt-1">
            <div class="flex items-center gap-2 mb-1">
                <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">{{ instance.supply.category.name }}</span>
                {% if instance.status == 'available' %}
                <span class="px-2 py-0.5 rounded-full bg-green-500/10 border border-green-500/20 text-[9px] font-bold text-green-400 uppercase tracking-wider">Available</span>
                {% elif instance.status == 'borrowed' %}
                <span class="px-2 py-0.5 rounded-full bg-blue-500/10 border border-blue-500/20 text-[9px] font-bold text-blue-400 uppercase tracking-wider">Borrowed</span>
                {% elif instance.status == 'maintenance' %}
                <span class="px-2 py-0.5 rounded-full bg-amber-500/10 border border-amber-500/20 text-[9px] font-bold text-amber-400 uppercase tracking-wider">Maintenance</span>
                {% elif instance.status == 'damaged' %}
                <span class="px-2 py-0.5 rounded-full bg-red-500/10 border border-red-500/20 text-[9px] font-bold text-red-400 uppercase tracking-wider">Damaged</span>
                {% elif instance.status == 'lost' %}
                <span class="px-2 py-0.5 rounded-full bg-red-500/10 border border-red-500/20 text-[9px] font-bold text-red-400 uppercase tracking-wider">Lost</span>
                {% endif %}
            </div>
            <h2 class="text-xl font-bold text-white mb-1">{{ instance.instance_code }}</h2>
            <p class="text-sm text-slate-400">{{ instance.supply.name }}</p>
        </div>
    </div>
    
    <div class="p-6 pt-2 space-y-5">
        <!-- Details Grid -->
        <div class="grid grid-cols-2 gap-3">
            <div class="bg-slate-800/50 border border-slate-700/50 rounded-xl p-4">
                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-wider mb-1">Serial Number</p>
                <p class="font-mono text-sm text-white">{{ instance.serial_number|default:"—" }}</p>
            </div>
            <div class="bg-slate-800/50 border border-slate-700/50 rounded-xl p-4">
                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-wider mb-1">Supply Type</p>
                <p class="text-sm text-white">{{ instance.supply.name }}</p>
            </div>
            <div class="bg-slate-800/50 border border-slate-700/50 rounded-xl p-4">
                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-wider mb-1">Current Borrower</p>
                <p class="text-sm text-white">{{ instance.current_borrower.get_full_name|default:"—" }}</p>
            </div>
            <div class="bg-slate-800/50 border border-slate-700/50 rounded-xl p-4">
                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-wider mb-1">Location</p>
                <p class="text-sm text-white">{{ instance.location|default:"—" }}</p>
            </div>
        </div>
        
        <!-- Activity Timeline -->
        <div>
            <h3 class="text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3">Recent Activity</h3>
            <div class="space-y-2">
                {% if instance.last_borrowed_at %}
                <div class="flex items-center gap-3 p-3 bg-slate-800/30 border border-slate-700/30 rounded-lg">
                    <div class="w-8 h-8 rounded-lg bg-blue-500/10 flex items-center justify-center">
                        <i data-lucide="log-out" class="w-4 h-4 text-blue-400"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-white">Borrowed</p>
                        <p class="text-xs text-slate-500">{{ instance.last_borrowed_at|date:"M d, Y g:i A" }}</p>
                    </div>
                </div>
                {% endif %}
                {% if instance.last_returned_at %}
                <div class="flex items-center gap-3 p-3 bg-slate-800/30 border border-slate-700/30 rounded-lg">
                    <div class="w-8 h-8 rounded-lg bg-green-500/10 flex items-center justify-center">
                        <i data-lucide="log-in" class="w-4 h-4 text-green-400"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-white">Returned</p>
                        <p class="text-xs text-slate-500">{{ instance.last_returned_at|date:"M d, Y g:i A" }}</p>
                    </div>
                </div>
                {% endif %}
                {% if not instance.last_borrowed_at and not instance.last_returned_at %}
                <p class="text-sm text-slate-500 text-center py-4">No activity recorded</p>
                {% endif %}
            </div>
        </div>
        
        <!-- Actions -->
        <div class="flex gap-3 pt-4 border-t border-slate-700">
            {% if instance.status == 'available' %}
            <a href="{% url 'request_create' %}?instance={{ instance.id }}" 
               class="flex-1 px-4 py-3 bg-green-600 hover:bg-green-500 rounded-xl font-medium text-white transition-all inline-flex items-center justify-center gap-2"
               up-dismiss>
                <i data-lucide="hand" class="w-4 h-4"></i>
                Request Equipment
            </a>
            {% endif %}
            
            {% if instance.qr_code %}
            <a href="{% url 'equipment_qr' instance.id %}" 
               class="px-4 py-3 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded-xl font-medium text-white transition-all inline-flex items-center justify-center gap-2"
               up-layer="root" up-modal="large">
                <i data-lucide="qr-code" class="w-4 h-4"></i>
                View QR
            </a>
            {% endif %}
            
            <button class="px-4 py-3 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded-xl font-medium text-white transition-all" up-dismiss>
                Close
            </button>
        </div>
    </div>
</div>
{% endblock %}
