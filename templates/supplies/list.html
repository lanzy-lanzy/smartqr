{% extends 'base.html' %}
{% load static %}

{% block title %}Supplies - Smart Supply{% endblock %}
{% block page_title %}Supplies{% endblock %}

{% block content %}
<div class="space-y-6 fade-in">
    <!-- Header & Filters -->
    <div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6">
        <div>
            <h2 class="heading-lg">Browse Supplies</h2>
            <p class="text-slate-400 mt-2">Find and request equipment and supplies for your department</p>
        </div>
        
        <a href="{% url 'request_create' %}" up-follow class="inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-gradient-to-r from-primary-600 to-primary-500 hover:from-primary-500 hover:to-primary-400 text-white font-semibold transition-all duration-300 hover:shadow-lg hover:shadow-primary-500/30 whitespace-nowrap">
            <i data-lucide="plus" class="w-5 h-5"></i>
            New Request
        </a>
    </div>
    
    <!-- Filters Section -->
    <div class="rounded-2xl border border-white/10 bg-gradient-to-br from-white/5 to-white/[0.02] backdrop-blur-xl p-6" x-data="{ filtersOpen: false }">
        <div class="flex flex-col md:flex-row gap-4">
            <!-- Search -->
            <div class="flex-1 relative">
                <div class="absolute left-4 top-1/2 -translate-y-1/2 flex items-center justify-center">
                    <i data-lucide="search" class="w-5 h-5 text-slate-500"></i>
                </div>
                <input type="text" 
                       placeholder="Search supplies by name..." 
                       class="w-full pl-12 pr-4 py-3 rounded-xl bg-white/5 border border-white/10 hover:border-white/20 focus:border-primary-500/50 text-white placeholder-slate-500 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/20"
                       name="search"
                       value="{{ search }}"
                       hx-get="{% url 'supplies' %}"
                       hx-trigger="keyup changed delay:300ms"
                       hx-target="#supply-grid"
                       hx-include="[name='category'], [name='stock']">
            </div>
            
            <!-- Category Filter -->
            <div class="relative md:w-48">
                <select name="category" 
                        class="select w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 hover:border-white/20 focus:border-primary-500/50 text-white transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/20 cursor-pointer appearance-none"
                        hx-get="{% url 'supplies' %}"
                        hx-trigger="change"
                        hx-target="#supply-grid"
                        hx-include="[name='search'], [name='stock']">
                    <option value="">All Categories</option>
                    {% for cat in categories %}
                    <option value="{{ cat.id }}" {% if current_category == cat.id|stringformat:"s" %}selected{% endif %}>
                        {{ cat.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Stock Filter -->
            <div class="relative md:w-40">
                <select name="stock" 
                        class="select w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 hover:border-white/20 focus:border-primary-500/50 text-white transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/20 cursor-pointer appearance-none"
                        hx-get="{% url 'supplies' %}"
                        hx-trigger="change"
                        hx-target="#supply-grid"
                        hx-include="[name='search'], [name='category']">
                    <option value="">All Stock</option>
                    <option value="available" {% if stock_status == 'available' %}selected{% endif %}>In Stock</option>
                    <option value="low" {% if stock_status == 'low' %}selected{% endif %}>Low Stock</option>
                    <option value="out" {% if stock_status == 'out' %}selected{% endif %}>Out of Stock</option>
                </select>
            </div>
            
            <!-- Clear Filters -->
            {% if search or current_category or stock_status %}
            <button type="button"
               class="inline-flex items-center gap-2 px-4 py-3 rounded-xl bg-white/5 border border-white/10 hover:border-red-500/50 text-slate-300 hover:text-red-400 transition-colors whitespace-nowrap"
               hx-get="{% url 'supplies' %}"
               hx-target="#supply-grid">
                <i data-lucide="x" class="w-4 h-4"></i>
                Clear
            </button>
            {% endif %}
        </div>
    </div>
    
    <!-- Supply Grid -->
    <div id="supply-grid">
        {% include 'partials/supply_grid.html' %}
    </div>
</div>
{% endblock %}
