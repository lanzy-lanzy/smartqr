{% extends 'base.html' %}
{% load static %}

{% block title %}Supplies - Smart Supply{% endblock %}
{% block page_title %}Supplies{% endblock %}

{% block content %}
<div class="space-y-6 fade-in">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
            <h2 class="text-3xl font-semibold text-white">Supplies</h2>
            <p class="text-slate-400 text-sm mt-1">Browse and request equipment and supplies</p>
        </div>
        
        <div class="flex items-center gap-2">
            {% if user.role == 'admin' or user.role == 'gso_staff' %}
            <a href="{% url 'supply_create' %}" up-follow class="inline-flex items-center gap-2 px-4 py-2.5 rounded-lg border border-slate-800 text-slate-300 hover:border-slate-700 hover:bg-slate-900/50 text-sm font-medium transition-all">
                <i data-lucide="plus" class="w-4 h-4"></i>
                Add
            </a>
            {% endif %}
            
            <a href="{% url 'request_create' %}" up-follow class="inline-flex items-center gap-2 px-4 py-2.5 rounded-lg bg-primary-600 hover:bg-primary-700 text-white text-sm font-medium transition-all">
                <i data-lucide="plus" class="w-4 h-4"></i>
                New Request
            </a>
        </div>
    </div>
    
    <!-- Filters -->
    <div class="flex flex-col sm:flex-row gap-3">
        <!-- Search -->
        <div class="flex-1 relative">
            <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"></i>
            <input type="text" 
                   placeholder="Search supplies..." 
                   class="w-full pl-10 pr-4 py-2.5 rounded-lg bg-slate-900/50 border border-slate-800 text-white placeholder-slate-600 text-sm transition-all focus:outline-none focus:border-slate-700"
                   name="search"
                   value="{{ search }}"
                   hx-get="{% url 'supplies' %}"
                   hx-trigger="keyup changed delay:300ms"
                   hx-target="#supply-grid"
                   hx-include="[name='category'], [name='stock']">
        </div>
        
        <!-- Category Filter -->
        <select name="category" 
                class="select px-4 py-2.5 rounded-lg bg-slate-900/50 border border-slate-800 text-white text-sm transition-all focus:outline-none focus:border-slate-700 cursor-pointer appearance-none w-full sm:w-40"
                hx-get="{% url 'supplies' %}"
                hx-trigger="change"
                hx-target="#supply-grid"
                hx-include="[name='search'], [name='stock']">
            <option value="">All Categories</option>
            {% for cat in categories %}
            <option value="{{ cat.id }}" {% if current_category == cat.id|stringformat:"s" %}selected{% endif %}>
                {{ cat.name }}
            </option>
            {% endfor %}
        </select>
        
        <!-- Stock Filter -->
        <select name="stock" 
                class="select px-4 py-2.5 rounded-lg bg-slate-900/50 border border-slate-800 text-white text-sm transition-all focus:outline-none focus:border-slate-700 cursor-pointer appearance-none w-full sm:w-36"
                hx-get="{% url 'supplies' %}"
                hx-trigger="change"
                hx-target="#supply-grid"
                hx-include="[name='search'], [name='category']">
            <option value="">All Stock</option>
            <option value="available" {% if stock_status == 'available' %}selected{% endif %}>In Stock</option>
            <option value="low" {% if stock_status == 'low' %}selected{% endif %}>Low Stock</option>
            <option value="out" {% if stock_status == 'out' %}selected{% endif %}>Out</option>
        </select>
        
        <!-- Clear Filters -->
        {% if search or current_category or stock_status %}
        <button type="button"
           class="inline-flex items-center gap-2 px-4 py-2.5 rounded-lg border border-slate-800 text-slate-500 hover:text-slate-300 hover:border-slate-700 text-sm font-medium transition-all"
           hx-get="{% url 'supplies' %}"
           hx-target="#supply-grid">
             <i data-lucide="x" class="w-4 h-4"></i>
             Clear
         </button>
        {% endif %}
    </div>
    
    <!-- Supply Grid -->
    <div id="supply-grid">
        {% include 'partials/supply_grid.html' %}
    </div>
</div>
{% endblock %}
